# This policy uses the Sentinel tfplan/v2 import to require that
# storage account resources have https_traffic_only enabled

import "tfplan-functions" as tfplan

allAzureStorageAccount = tfplan.find_resources("azurerm_storage_account")

enable_https_traffic_only_is_true = rule {
	all allAzureStorageAccount as _, accounts {
		accounts.change.after.enable_https_traffic_only is true
	}
}

main = rule {
	enable_https_traffic_only_is_true
}